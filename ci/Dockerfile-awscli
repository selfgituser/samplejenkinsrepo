FROM docker:24.0-cli

USER root

# ✅ Ensure aws install path is available in all steps
ENV PATH="/usr/local/bin:${PATH}"

# ✅ Install AWS CLI v2
RUN apk add --no-cache curl unzip \
 && curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip" \
 && unzip awscliv2.zip \
 && ./aws/install \
 && rm -rf awscliv2.zip aws

# ✅ Now it can find both aws and docker
RUN aws --version && docker --version

